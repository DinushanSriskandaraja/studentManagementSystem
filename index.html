<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Student Management System</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPC7hVGRtfwzsH4OfBuJymYtMj2QB2g7c3Y+Y51FMuxd6K" crossorigin="anonymous" />

    <style>
        body {
            font-family: sans-serif;
            background-color: #f8f9fa;
            justify-content: center;
        }
        
        .container {
            font-size: large;
        }
        
        .table-striped {
            overflow-x: auto;
            align-items: center;
        }
        
        .form-control {
            padding: 3px 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        
        th,
        td {
            font-size: small;
            padding: 3px 5px;
            border: 1px solid #ccc;
            text-align: center;
            width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            font-size: 12pt;
        }
        
        th {
            background-color: #dbdbdb;
        }
        
        .btn {
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .btn-primary {
            background-color: #007bff;
            color: #fff;
        }
        
        .btn-primary:hover {
            background-color: #0062cc;
            border-color: #005cbf;
        }
        
        .btn-warning {
            background-color: #ffc107;
            color: #fff;
        }
        
        .btn-warning:hover {
            background-color: #f7b84b;
            border-color: #f5a235;
        }
        
        .btn-danger {
            background-color: #dc3545;
            color: #fff;
        }
        
        .btn-danger:hover {
            background-color: #c1252d;
            border-color: #c1252d;
        }
        
        .btn-light {
            border-radius: 3px;
            background-color: #cfcfcf;
            border: 2px;
            border-color: #ccc;
        }
        
        .btn-light:hover {
            background-color: rgb(141, 141, 214);
        }
        
        @media (max-width: 1080px) {
            .container {
                padding: 10px;
            }
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <h2>Student Management System</h2>
        <div class="table-striped">
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>SID</th>
                            <th>First Name</th>
                            <th>Last Name</th>
                            <th>Email</th>
                            <th>Nearest City</th>
                            <th>Course</th>
                            <th>Subject</th>
                            <th>Guardian</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="student-table">

                        <tr>
                            <td>
                                <input type="text" class="form-control" placeholder="SID" />
                            </td>
                            <td>
                                <input type="text" class="form-control" placeholder="First Name" />
                            </td>
                            <td>
                                <input type="text" class="form-control" placeholder="Last Name" />
                            </td>
                            <td>
                                <input type="email" class="form-control" placeholder="Email" />
                            </td>
                            <td>
                                <input type="text" class="form-control" placeholder="Nearest City" />
                            </td>
                            <td>
                                <select class="form-control">
                                    <option value="">Select Course</option>
                                    <option value="computer-science">Computer Science</option>
                                    <option value="information-technology">Information Technology</option>
                                    <option value="business-administration">Business Administration</option>
                                </select>
                            </td>
                            <td>
                                <select class="form-control">
                                    <option>Select Subject</option>
                                    <option>IP</option>
                                    <option>OOP</option>
                                    <option>SE</option>
                                    <option>MC</option>
                                    <option>DCCN</option>
                                    <option>DBMS</option>
                                    <option>ETF</option>
                                    <option>WAD</option>
                                    <option>BE</option>
                                    <option>FC</option>
                                </select>
                            </td>
                            <td>
                                <input type="text" class="form-control" placeholder="Guardian" />
                            </td>
                            <td>
                              <button type="button" class="btn btn-primary" onclick="searchStudents()">Search</button>
                              <button type="button" class="btn btn-primary" onclick="addStudent()">ADD</button>


                            </td>
                        </tr>

                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div>
    </div>
    <!-- Include jQuery from a CDN -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

    <script>
        // Function to fetch and display students using Ajax
        function fetchStudents() {
            $.ajax({
                url: 'http://localhost:8080/students', // Update the URL with your server's address
                method: 'GET',
                dataType: 'json',
                success: function(students) {
                    // Call a function to display students on the page
                    displayStudents(students);
                },
                error: function(error) {
                    console.error('Error fetching data:', error);
                }
            });
        }

        // Function to display students in the table
        function displayStudents(students) {
            const studentTable = $('#student-table');

            // Preserve the input fields row
            const inputFieldsRow = studentTable.find('tr:first-child').clone();
            studentTable.empty().append(inputFieldsRow);

            // Populate the table with data
            students.forEach(function(student) {
                studentTable.append(`
            <tr>
                <td>${student.SID}</td>
                <td>${student.FirstName}</td>
                <td>${student.LastName}</td>
                <td>${student.Email}</td>
                <td>${student.NearestCity}</td>
                <td>${student.Course}</td>
                <td>${student.Subject}</td>
                <td>${student.Guardian}</td>
                <td>
                  <button type="button" class="btn btn-warning" onclick="editStudent(${student.SID})">EDIT</button>
                  <button type="button" class="btn btn-danger" onclick="deleteStudent(${student.SID})">DELETE</button>
                    
                </td>
            </tr>
        `);
            });
        }



        // Call the fetchStudents function when the page loads
        $(document).ready(function() {
            fetchStudents();
        });

        // Function to search students
        function searchStudents() {
          const searchValue = $('#search-input').val(); // Assuming you have an input field with id 'search-input'

          // Make an Ajax request to fetch students with the given search value
          $.ajax({
              url: 'http://localhost:8080/students', // Update the URL with your server's address
              method: 'GET',
              dataType: 'json',
              data: { search: searchValue }, // Pass the search value as a query parameter
              success: function(students) {
                  // Call a function to display the searched students on the page
                  displayStudents(students);
              },
              error: function(error) {
                  console.error('Error fetching searched data:', error);
              }
          });
        }

        // Function to add a new student
        function searchStudents() {
          const searchValue = $('#search-input').val(); // Assuming you have an input field with id 'search-input'

          // Make an Ajax request to fetch students with the given search value
          $.ajax({
              url: 'http://localhost:8080/students', // Update the URL with your server's address
              method: 'GET',
              dataType: 'json',
              data: { search: searchValue }, // Pass the search value as a query parameter
              success: function(students) {
                  // Call a function to display the searched students on the page
                  displayStudents(students);
              },
              error: function(error) {
                  console.error('Error fetching searched data:', error);
              }
          });
        }

        // Function to edit a student
        function editStudent(sid) {
            // Implement your logic for editing a student
            // You may need to fetch the specific student details for editing
        }

        // Function to delete a student
        function deleteStudent(sid) {
            // Confirm the deletion with the user
            const confirmDelete = confirm('Are you sure you want to delete this student?');

            if (confirmDelete) {
                // Make an Ajax request to delete the student
                $.ajax({
                    url: `http://localhost:8080/students/${sid}`, // Update the URL with your server's address
                    method: 'DELETE',
                    success: function (response) {
                        // Refresh the student table after deletion
                        fetchStudents();
                    },
                    error: function (error) {
                        console.error('Error deleting student:', error);
                    }
                });
            }
      	}
    </script>
</body>

</html>